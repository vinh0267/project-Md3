package ra.databinding.dao;import ra.databinding.model.entity.Category;import ra.databinding.until.ConnectJava;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;import java.util.ArrayList;import java.util.List;public class CategoriesDao {    public List<Category> findAll() {        Connection connection = null;        PreparedStatement preparedStatement = null;        ResultSet resultSet = null;        List<Category> categories = new ArrayList<>();        try {            // Mở kết nối tới cơ sở dữ liệu            connection = ConnectJava.openConnection();            // Chuẩn bị truy vấn SQL            String query = "SELECT * FROM Category";            preparedStatement = connection.prepareStatement(query);            // Thực thi truy vấn            resultSet = preparedStatement.executeQuery();            // Xử lý kết quả trả về            while (resultSet.next()) {                Category category = new Category();                category.setId(resultSet.getInt("id"));                category.setName(resultSet.getString("name"));                category.setStatus(resultSet.getBoolean("status"));                categories.add(category);            }        } catch (SQLException e) {            e.printStackTrace();        } finally {            // Đóng tất cả các tài nguyên            try {                if (resultSet != null) resultSet.close();                if (preparedStatement != null) preparedStatement.close();                if (connection != null) connection.close();            } catch (SQLException e) {                e.printStackTrace();            }        }        return categories;    }    public Category findById(Integer id) {        Connection connection = null;        PreparedStatement preparedStatement = null;        ResultSet resultSet = null;        Category category = null;        try {            // Mở kết nối tới cơ sở dữ liệu            connection = ConnectJava.openConnection();            // Chuẩn bị truy vấn SQL            String query = "SELECT * FROM Category WHERE id = ?";            preparedStatement = connection.prepareStatement(query);            preparedStatement.setInt(1, id);            // Thực thi truy vấn            resultSet = preparedStatement.executeQuery();            // Xử lý kết quả trả về            if (resultSet.next()) {                // Tạo một đối tượng Category từ kết quả truy vấn                category = new Category();                category.setId(resultSet.getInt("id"));                category.setName(resultSet.getString("name"));            }        } catch (SQLException e) {            e.printStackTrace();        } finally {            // Đóng tất cả các tài nguyên            try {                if (resultSet != null) resultSet.close();                if (preparedStatement != null) preparedStatement.close();                if (connection != null) connection.close();            } catch (SQLException e) {                e.printStackTrace();            }        }        return category;    }    public void save(Category category) {        Connection connection = null;        PreparedStatement preparedStatement = null;        try {            // Mở kết nối tới cơ sở dữ liệu            connection = ConnectJava.openConnection();            // Chuẩn bị truy vấn SQL            String query = "INSERT INTO Category (name,status) VALUES (?,?)";            preparedStatement = connection.prepareStatement(query);            preparedStatement.setString(1, category.getName());            preparedStatement.setBoolean(2, true);            // Thực thi truy vấn            preparedStatement.executeUpdate();        } catch (SQLException e) {            e.printStackTrace();        } finally {            // Đóng tất cả các tài nguyên            try {                if (preparedStatement != null) preparedStatement.close();                if (connection != null) connection.close();            } catch (SQLException e) {                e.printStackTrace();            }        }    }    public void remove(Integer id) {        Connection connection = null;        PreparedStatement preparedStatement = null;        try {            // Mở kết nối tới cơ sở dữ liệu            connection = ConnectJava.openConnection();            // Chuẩn bị truy vấn SQL            String query = "DELETE FROM Category WHERE id = ?";            preparedStatement = connection.prepareStatement(query);            preparedStatement.setInt(1, id);            // Thực thi truy vấn            preparedStatement.executeUpdate();        } catch (SQLException e) {            e.printStackTrace();        } finally {            // Đóng tất cả các tài nguyên            try {                if (preparedStatement != null) preparedStatement.close();                if (connection != null) connection.close();            } catch (SQLException e) {                e.printStackTrace();            }        }    }    // change status    public void changeStatus(int categoryId, boolean newStatus) {        Connection connection = null;        PreparedStatement preparedStatement = null;        try {            // Mở kết nối tới cơ sở dữ liệu            connection = ConnectJava.openConnection();            // Chuẩn bị truy vấn SQL            String query = "UPDATE Category SET status = ? WHERE id = ?";            preparedStatement = connection.prepareStatement(query);            preparedStatement.setBoolean(1, newStatus);            preparedStatement.setInt(2, categoryId);            // Thực thi truy vấn            preparedStatement.executeUpdate();        } catch (SQLException e) {            e.printStackTrace();        } finally {            // Đóng tất cả các tài nguyên            try {                if (preparedStatement != null) preparedStatement.close();                if (connection != null) connection.close();            } catch (SQLException e) {                e.printStackTrace();            }        }    }    // update    public void update(Category category) {        Connection connection = null;        PreparedStatement preparedStatement = null;        try {            // Mở kết nối tới cơ sở dữ liệu            connection = ConnectJava.openConnection();            // Chuẩn bị truy vấn SQL            String query = "UPDATE Category SET name = ?, status = ? WHERE id = ?";            preparedStatement = connection.prepareStatement(query);            preparedStatement.setString(1, category.getName());             preparedStatement.setBoolean(2, category.getStatus());            preparedStatement.setInt(3, category.getId());            // Thực thi truy vấn            preparedStatement.executeUpdate();        } catch (SQLException e) {            e.printStackTrace();        } finally {            // Đóng tất cả các tài nguyên            try {                if (preparedStatement != null) preparedStatement.close();                if (connection != null) connection.close();            } catch (SQLException e) {                e.printStackTrace();            }        }    }}